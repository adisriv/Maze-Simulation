# DESIGN : group 16

**Mazeworld** is a client application that simulates people searching for each other in a maze that is generated and managed by a separate server application.

The client solves mazes that are rectangular and "perfect" -- meaning there exists one and only one path from any point in the maze to any other point. In other words, there exist no inaccessible sections, circular paths, or open areas.

This program consists of two entities -- the startup process and the maze logic.

## Avatars.c

| arg                 | explanation                       |
| ------------------- | --------------------------------- |
| `nAvatars (int)`    | the number of avatars in the maze |
| `Difficulty (int)`  | the difficulty level (0-9)        |
| `Hostname (char *)` | the hostname of the server        |

`Avatars` is a client startup script that makes initial contact with the server. Initially, `Avatars` sends an `AM_INIT` message to the server at an `AM_SERVER_PORT`. The message contains the following information: `nAvatars` - the desired number of avatars in the maze, and `Difficulty` - the difficulty of the maze.

Upon receiving the `AM_INIT` message, the server generates a new maze and pseudo-randomly places avatars throughout it. Then, it sends an `AM_INIT_OK` message back to the client, acknowledging the initialization of the maze. The message contains a unique `Mazeport`, which is the TCP/IP port number that is used to communicate with the server regarding this maze. The server begins listening on the specified port immediately. Additionally, the `AM_INIT_OK` message contains the `MazeWidth` and `MazeHeight` of the new maze (both integers). `Avatars` extracts these values, then spins up n processes (one for each avatar). Each process runs `Avatars` -- the main client software (see below).

Next, each process sends an `AM_AVATAR_READY` message to the server containing it's `avatarID`, via the `MazePort`. Once the server receives messages from each avatar, the server responds by sending an identical `AM_AVATAR_TURN` message back to each process, containing each avatar's current (x, y) position in the maze, and a `turnID` indicating which avatar moves first.

On it's turn, each avatar sends an `AM_AVATAR_MOVE` message to the server specifying in which direction it wishes to move (see the **algorithm** design below).

Once the server determines whether the move was feasible (i.e., not moving through a wall or the boundary of the maze), it sends every avatar an updated `AM_AVATAR_TURN` message containing the current (updated) positions of all avatars. Additionally, the server increments the `turnID` (modulo n) so that the next avatar can go.

This process continues until terminating conditions occur. We define terminating conditions to be:

* a broken socket connection
* the maximum number of moves is exceeded
* the server's `AM_WAIT_TIME` timer expires
* the server determines that all of the avatars are located in the same (x, y) position, meaning the maze has been solved.

Finally, when the maze is solved, the server sends an `AM_MAZE_SOLVED` message to all of the avatars. At this point, the avatars log their success/progress, close files, free allocated memory, and exit.

## Algorithm: wall follower

Because avatars do not know the layout of the maze in advance, and have no way of sensing walls or junctions (besides by unsuccessfully attempting to move into one), many of the more efficient maze-solving algorithms will not work for Mazeworld.

The wall follower algorithm is a good candidate for this use case. Because Mazeworld consists solely of perfect mazes, the wall follower algorithm is guaranteed to solve any maze generated by the server. It is not, however, guaranteed to find the shortest path.

### pseudocode

* if goal has been reached: - do not move
* else:
  * if there is no left wall: - rotate 90 degrees, go forward - else if there is no front wall: - go forward - else rotate 90 degrees

[source](Usage:%20AvatarId,%20nAvatars,%20Difficulty,%20IP%20address%20of%20the%20server,%20MazePort,%20Filename%20of%20the%20log.)
